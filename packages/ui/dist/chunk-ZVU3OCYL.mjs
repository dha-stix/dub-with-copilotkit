"use client"
import{c as A}from"./chunk-IJKYRUH2.mjs";import{a as j}from"./chunk-KJXXB2M5.mjs";import{a as T}from"./chunk-GVBIGY6N.mjs";import{a as S}from"./chunk-NWME2ANF.mjs";import{a as K}from"./chunk-AIFNU5LD.mjs";import{a as H}from"./chunk-LPV7TLRR.mjs";import{a as z}from"./chunk-L775CDS5.mjs";import{a as M}from"./chunk-YURUGH4S.mjs";import{m as O,o as k}from"./chunk-PTW2A7PR.mjs";import{Command as d,useCommandState as U}from"cmdk";import{ChevronDown as Z,ListFilter as q}from"lucide-react";import{forwardRef as G,isValidElement as $,useCallback as N,useEffect as J,useImperativeHandle as X,useRef as E,useState as R}from"react";import{Fragment as B,jsx as n,jsxs as i}from"react/jsx-runtime";function ye({filters:e,onSelect:r,onRemove:a,onOpenFilter:l,activeFilters:s,askAI:u,children:h,emptyState:c,className:b}){var L;let{isMobile:g}=S(),v=E(null),P=E(),[x,f]=R(!1);A("f",()=>f(!0),{enabled:!x});let[y,w]=R(""),[p,F]=R(null),C=N(()=>{w(""),F(null)},[]);J(()=>{x||C()},[x]);let o=p?e.find(({key:t})=>t===p):null,V=N(t=>{v.current&&(P.current={width:v.current.scrollWidth,height:v.current.scrollHeight}),w(""),F(t),l==null||l(t)},[]),D=N(t=>{if(!o||!s)return!1;let m=s.find(({key:Q})=>Q===p);return(m==null?void 0:m.value)===t||m&&o.multiple&&Array.isArray(m.value)&&m.value.includes(t)},[o]),I=N(t=>{o&&(D(t)?a(o.key,t):r(o.key,t),o.multiple||f(!1))},[s,o,u]);return n(j,{openPopover:x,setOpenPopover:f,onEscapeKeyDown:t=>{p&&(t.preventDefault(),C())},content:n(K,{width:!g,height:!0,className:"rounded-[inherit]",style:{transform:"translateZ(0)"},children:i(d,{loop:!0,children:[i("div",{className:"flex items-center overflow-hidden rounded-t-lg border-b border-gray-200",children:[n(_,{placeholder:`${(o==null?void 0:o.label)||"Filter"}...`,value:y,onValueChange:w,onKeyDown:t=>{(t.key==="Escape"||t.key==="Backspace"&&!y)&&(t.preventDefault(),t.stopPropagation(),p?C():f(!1))},emptySubmit:t=>{t.preventDefault(),t.stopPropagation(),u?(r("ai",o?`${o.label} ${y}`:y),f(!1)):I(y)}}),!o&&n("kbd",{className:"mr-2 hidden shrink-0 rounded bg-gray-200 px-2 py-0.5 text-xs font-light text-gray-500 md:block",children:"F"})]}),n(ee,{ref:v,children:i(d.List,{className:k("flex w-full flex-col gap-1 p-1",o?"min-w-[100px]":"min-w-[180px]"),children:[o?((L=o.options)==null?void 0:L.map(t=>{let m=D(t.value);return n(W,{filter:o,option:t,right:m?n(H,{className:"h-4 w-4"}):t.right,onSelect:()=>I(t.value)},t.value)}))??n(d.Loading,{children:n("div",{className:"-m-1 flex items-center justify-center",style:P.current,children:n(z,{})})}):e.map(t=>i(B,{children:[n(W,{filter:t,onSelect:()=>V(t.key)},t.key),t.separatorAfter&&n(d.Separator,{className:"-mx-1 my-1 border-b border-gray-200"})]})),(!o||o.options)&&n(te,{search:y,askAI:u,children:c?Y(c)?(c==null?void 0:c[p??"default"])??"No matches":c:"No matches"})]})},p)]})}),children:i("button",{type:"button",className:k("group flex h-10 cursor-pointer appearance-none items-center gap-x-2 truncate rounded-md border px-3 text-sm outline-none transition-all","border-gray-200 bg-white text-gray-900 placeholder-gray-400","focus-visible:border-gray-500 data-[state=open]:border-gray-500 data-[state=open]:ring-4 data-[state=open]:ring-gray-200",b),children:[n(q,{className:"size-4 shrink-0"}),n("span",{className:"flex-1 overflow-hidden text-ellipsis whitespace-nowrap text-left text-gray-900",children:h??"Filter"}),s!=null&&s.length?n("div",{className:"flex size-4 shrink-0 items-center justify-center rounded-full bg-black text-[0.625rem] text-white",children:s.length}):n(Z,{className:"size-4 shrink-0 text-gray-400 transition-transform duration-75 group-data-[state=open]:rotate-180"})]})})}function Y(e){return typeof e=="object"&&e!==null&&!$(e)}var _=e=>{let r=U(a=>a.filtered.count===0);return n(d.Input,{...e,size:1,className:"grow border-0 py-3 pl-4 pr-2 text-sm outline-none placeholder:text-gray-400 focus:ring-0",onKeyDown:a=>{var l,s;(l=e.onKeyDown)==null||l.call(e,a),a.key==="Enter"&&r&&((s=e.emptySubmit)==null||s.call(e,a))}})},ee=G(({children:e},r)=>{let a=E(null);X(r,()=>a.current);let{scrollProgress:l,updateScrollProgress:s}=T(a);return i(B,{children:[n("div",{className:"scrollbar-hide max-h-[50vh] w-screen overflow-y-scroll sm:w-auto",ref:a,onScroll:s,children:e}),n("div",{className:"pointer-events-none absolute bottom-0 left-0 hidden h-16 w-full bg-gradient-to-t from-white sm:block",style:{opacity:1-Math.pow(l,2)}})]})});function W({filter:e,option:r,right:a,onSelect:l}){var c,b;let{isMobile:s}=S(),u=r?r.icon??((c=e.getOptionIcon)==null?void 0:c.call(e,r.value,{key:e.key,option:r}))??e.icon:e.icon,h=r?r.label??((b=e.getOptionLabel)==null?void 0:b.call(e,r.value,{key:e.key,option:r})):e.label;return i(d.Item,{className:k("flex cursor-pointer items-center gap-3 whitespace-nowrap rounded-md px-3 py-2 text-left text-sm","data-[selected=true]:bg-gray-100"),onPointerDown:g=>{g.preventDefault()},onPointerUp:g=>{g.preventDefault(),s?setTimeout(l,100):l()},onSelect:l,value:h+(r==null?void 0:r.value),children:[n("span",{className:"shrink-0 text-gray-600",children:ne(u)?u:n(u,{className:"h-4 w-4"})}),O(h,48),n("div",{className:"ml-1 flex shrink-0 grow justify-end text-gray-500",children:a})]})}var te=({search:e,askAI:r,children:a})=>r&&e?i(d.Empty,{className:"flex min-w-[180px] items-center space-x-2 rounded-md bg-gray-100 px-3 py-2",children:[n(M,{className:"h-4 w-4"}),i("p",{className:"text-center text-sm text-gray-600",children:["Ask AI ",i("span",{className:"text-black",children:['"',e,'"']})]})]}):n(d.Empty,{className:"p-2 text-center text-sm text-gray-400",children:a}),ne=e=>$(e);export{ye as a};
